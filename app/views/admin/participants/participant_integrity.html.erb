<% title "Participant Integrity Reports" %>

<h1><%= yield(:title) %></h1>

<h3>Participants with zero age (<%= @participants.size %>)</h3>

<% if @participants.empty? %>
	<p>None</p>

<% else %>
	<div class="accordion" id="age0_accordion">
		<div class="accordion-item">
			<h3 class="accordion-header" id="age0_heading">
				<button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#age0_collapse" aria-expanded="false" aria-controls="age0_collapse">
					Show participants (click to expand)
				</button>
			</h3>
			<div id="age0_collapse" class="accordion-collapse collapse" aria-labelledby="age0_heading" data-bs-parent="#age0_accordion">
				<div class="accordion-body">
					<table class="table table-dark table-striped">
						<% @participants.each do |p| %>
							<tr valign="top">
								<td>
									<%= p.name %>
								</td>
							</tr>
						<% end %>
					</table>
				</div>
			</div>
		</div>
	</div>
<% end %>

<br/>
<br/>

<h3>Users with more than three participants (<%= @user_integrity.size %>)</h3>

<% if @user_integrity.empty? %>
	<p>None</p>

<% else %>
	<div class="accordion" id="user_accordion">
		<div class="accordion-item">
			<h3 class="accordion-header" id="user_heading">
				<button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#user_collapse" aria-expanded="false" aria-controls="user_collapse">
					Show users (click to expand)
				</button>
			</h3>
			<div id="user_collapse" class="accordion-collapse collapse" aria-labelledby="user_heading" data-bs-parent="#user_accordion">
				<div class="accordion-body">
					<table class="table table-dark table-striped">
						<% @user_integrity.each do |u| %>
							<tr valign="top">
								<td>
									<%= "#{u.name} (#{u.participants.accepted.coming.count})" %>
								</td>
							</tr>
						<% end %>
					</table>
				</div>
			</div>
		</div>
	</div>
<% end %>
